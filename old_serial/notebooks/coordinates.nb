(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14780,        375]
NotebookOptionsPosition[     13477,        342]
NotebookOutlinePosition[     14025,        363]
CellTagsIndexPosition[     13938,        358]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{"Quit", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "need", " ", "to", " ", "reset", " ", "all", " ", "variables", " ", 
    "before", " ", "running", " ", "if", " ", "changing", " ", 
    RowBox[{"dimension", "!"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.769448582593945*^9, 3.769448582968234*^9}, {
  3.7694487316901207`*^9, 3.769448750219501*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"93aef7d3-8fd5-4549-a020-387902c711d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Symbolic", " ", "implementation", " ", "of", " ", "coordinate", 
    " ", "conversions", " ", "on", " ", "the", " ", 
    RowBox[{"lattice", ".", " ", "My"}], " ", "lattice", " ", "sites", " ", 
    "are", " ", "parametrized", " ", "with", " ", "a", " ", "single", " ", 
    "index", " ", "as", " ", 
    RowBox[{
     RowBox[{"x", "[", "i", "]"}], ".", " ", "Here"}], " ", "I", " ", 
    "provide", " ", "general", " ", "relations", " ", "for", " ", "convering",
     " ", "the", " ", "site", " ", "index", " ", "i", " ", "to", " ", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z", ",", "..."}], ")"}], " ", "and", " ", 
    "vice", " ", 
    RowBox[{"versa", "."}]}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", "seems", " ", "to", " ", "work", " ", "properly"}], ",",
     " ", 
    RowBox[{"but", " ", "is", " ", "slow", " ", "for", " ", "large", " ", 
     RowBox[{"lattices", "!"}]}]}], " ", "**)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "sites", " ", "are", " ", "labeled", " ", "as", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(", GridBox[{
        {"0", "1", "2"},
        {"3", "4", "5"},
        {"6", "7", "8"},
        {"9", "10", "11"}
       }], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "dir1", " ", "left", " ", "to", " ", "right", " ", "and", " ", "dir2", 
      " ", "up", " ", "to", " ", 
      RowBox[{"bottom", ".", " ", "dir3"}], " ", "comes", " ", "out", " ", 
      "of", " ", "the", " ", "page", " ", "as", "\[IndentingNewLine]", " ", 
      "dir3"}], "=", 
     RowBox[{"1", ":", " ", 
      RowBox[{"(", GridBox[{
         {"12", "13", "14"},
         {"15", "16", "17"},
         {"18", "19", "20"},
         {"21", "22", "23"}
        }], ")"}]}]}], " ", ",", "\[IndentingNewLine]", 
    RowBox[{"etc", "."}]}], "\[IndentingNewLine]", " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"spacetime", " ", "dimension"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"side", " ", "lengths"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"L", "[", "i", "]"}], "=", "500"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", "1", "]"}], "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", "2", "]"}], "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", "3", "]"}], "=", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vol", "=", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"L", "[", "l", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"1", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Mod", "[", 
      RowBox[{"i", ",", 
       RowBox[{"L", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"d", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Floor", "[", 
      FractionBox["i", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"L", "[", "j", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"dir_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Floor", "[", 
      FractionBox[
       RowBox[{"i", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"k", ",", "i"}], "]"}], 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"L", "[", "l", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"dir", "+", "1"}], ",", "d"}], "}"}]}], "]"}]}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"L", "[", "l", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", 
           RowBox[{"dir", "-", "1"}]}], "}"}]}], "]"}]], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"in", " ", "actual", " ", "implementation"}], ",", " ", 
     RowBox[{
     "take", " ", "only", " ", "x", " ", "array", " ", "as", " ", "an", " ", 
      "argument", " ", "since", " ", "by", " ", "assumption", " ", "we", " ", 
      "know", " ", "the", " ", "coords", " ", "x1"}], ",", " ", "x2", ",", 
     " ", 
     RowBox[{"...", " ", "when", " ", "calling", " ", "this"}]}], " ", "*)"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexFromCoord", "[", 
     RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"L", "[", "j", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dir", "-", "1"}]}], "}"}]}], "]"}], 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"dir", ",", "i"}], "]"}], "+", 
          RowBox[{"L", "[", "dir", "]"}]}], ",", 
         RowBox[{"L", "[", "dir", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"dir", ",", "1", ",", "d"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "test", " ", "by", " ", "calculating", " ", "the", " ", "coordinates", 
     " ", "for", " ", "each", " ", "i", " ", "and", " ", "then", " ", 
     "calculate", " ", "i", " ", "from", " ", "those"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"indexFromCoord", "[", 
        RowBox[{"x", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"vol", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"vol", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"aa", ",", "bb"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7694441518175373`*^9, 3.7694443432224617`*^9}, {
   3.769444379926298*^9, 3.7694444399612427`*^9}, {3.769445954766779*^9, 
   3.7694461385201273`*^9}, {3.7694461777818193`*^9, 3.769446233670114*^9}, 
   3.76944628986616*^9, {3.7694463413136253`*^9, 3.769446349933672*^9}, {
   3.769446390864519*^9, 3.769446531377096*^9}, {3.769446563242743*^9, 
   3.769446671471766*^9}, {3.76944683329646*^9, 3.7694468501466913`*^9}, {
   3.7694468849316883`*^9, 3.769446932486678*^9}, {3.7694469813203993`*^9, 
   3.769447003600237*^9}, {3.7694470663425007`*^9, 3.769447153978181*^9}, {
   3.769447185442415*^9, 3.769447298312441*^9}, {3.769447423058696*^9, 
   3.769447674019022*^9}, {3.769447716632558*^9, 3.769447731375169*^9}, {
   3.769447872437064*^9, 3.769448038572723*^9}, {3.769448171257453*^9, 
   3.76944818467732*^9}, {3.769448231645941*^9, 3.769448247609581*^9}, {
   3.769448325232369*^9, 3.769448367925276*^9}, {3.769448411718616*^9, 
   3.769448442847308*^9}, {3.769448534173616*^9, 3.7694485932820272`*^9}, {
   3.7694486846447077`*^9, 3.769448711377396*^9}, {3.7694487518758707`*^9, 
   3.769448994149238*^9}, {3.769449136025628*^9, 3.769449139087291*^9}, {
   3.769449218827477*^9, 3.769449223402429*^9}, {3.769449254549424*^9, 
   3.769449261972825*^9}, {3.769449434196269*^9, 3.769449435384346*^9}, {
   3.769449851572101*^9, 3.7694500277526693`*^9}, {3.770037064138465*^9, 
   3.7700370679698257`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"33afe9bf-af38-49ff-9553-cc4ba8af25b0"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7694464923459597`*^9, 3.769446532010326*^9}, {
   3.7694465636379232`*^9, 3.769446630433132*^9}, {3.769446671957982*^9, 
   3.769446676698058*^9}, 3.769446807588958*^9, {3.769446843771886*^9, 
   3.769446850542635*^9}, {3.769446885351218*^9, 3.769446932718749*^9}, {
   3.769446992274791*^9, 3.7694470040789633`*^9}, 3.76944707447373*^9, {
   3.769447108390883*^9, 3.769447154381679*^9}, {3.769447536121401*^9, 
   3.769447577060727*^9}, {3.769447637291349*^9, 3.769447678913805*^9}, {
   3.769447717890151*^9, 3.769447746813777*^9}, 3.769447874919443*^9, {
   3.7694483088000183`*^9, 3.769448357426587*^9}, {3.769448409818647*^9, 
   3.769448444319447*^9}, {3.769448569427299*^9, 3.769448596123197*^9}, {
   3.769448695642846*^9, 3.769448720881878*^9}, {3.769448788593135*^9, 
   3.769448798153829*^9}, 3.769448993721632*^9, 3.769449139567893*^9, {
   3.769449215414853*^9, 3.769449237537839*^9}, 3.7700370759300957`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"28269b35-e09a-4a41-8aaf-57552f9136ac"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ixy", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"x", "+", "Lx"}], ",", "Lx"}], "]"}], "+", 
     RowBox[{"Lx", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"y", "+", "Ly"}], ",", "Ly"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ixy", "[", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], ",", 
      RowBox[{"y", "[", "i", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{
       RowBox[{"Ly", " ", "Lx"}], "-", "1"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.769446168654442*^9, 3.769446170757318*^9}, 
   3.769446480447939*^9},ExpressionUUID->"bff4e38f-fe50-478b-a2e7-\
6a86c10a8f1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MatchQ"}]], "Input",
 CellChangeTimes->{{3.769448658660449*^9, 3.769448660943016*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"4c5bedfd-c3ea-489e-bed5-8e8fc1de45c1"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*RowBox[{\\\"MatchQ\\\", \\\"[\\\", RowBox[{StyleBox[\\\
\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"form\\\", \\\"TI\\\"]}], \
\\\"]\\\"}]\\) returns True if the pattern \\!\\(\\*StyleBox[\\\"form\\\", \\\
\"TI\\\"]\\) matches \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\), and \
returns False otherwise.\\n\\!\\(\\*RowBox[{\\\"MatchQ\\\", \\\"[\\\", \
StyleBox[\\\"form\\\", \\\"TI\\\"], \\\"]\\\"}]\\) represents an operator \
form of MatchQ that can be applied to an expression.\"\>", 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/MatchQ"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.769448661337418*^9},
 CellTags->
  "Info233769459461-2867981",ExpressionUUID->"7c6d3f27-d9f7-4b03-a484-\
017019e2fe7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "c", ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7694486647463617`*^9, 3.7694486764815893`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"1e3576eb-2814-44f5-afe0-86af587104bf"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.769448673614607*^9, 3.769448677035839*^9}},
 CellLabel->"Out[25]=",ExpressionUUID->"dde3356a-82b9-4ab6-8a42-06a332a8bfdb"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 1}, {Automatic, 29}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info233769459461-2867981"->{
  Cell[12043, 305, 852, 17, 72, "Print",ExpressionUUID->"7c6d3f27-d9f7-4b03-a484-017019e2fe7b",
   CellTags->"Info233769459461-2867981"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info233769459461-2867981", 13776, 352}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 481, 9, 55, "Input",ExpressionUUID->"93aef7d3-8fd5-4549-a020-387902c711d5"],
Cell[CellGroupData[{
Cell[1064, 33, 8748, 215, 1418, "Input",ExpressionUUID->"33afe9bf-af38-49ff-9553-cc4ba8af25b0"],
Cell[9815, 250, 1055, 14, 35, "Output",ExpressionUUID->"28269b35-e09a-4a41-8aaf-57552f9136ac"]
}, Open  ]],
Cell[10885, 267, 936, 29, 101, "Input",ExpressionUUID->"bff4e38f-fe50-478b-a2e7-6a86c10a8f1c"],
Cell[CellGroupData[{
Cell[11846, 300, 194, 3, 31, "Input",ExpressionUUID->"4c5bedfd-c3ea-489e-bed5-8e8fc1de45c1"],
Cell[12043, 305, 852, 17, 72, "Print",ExpressionUUID->"7c6d3f27-d9f7-4b03-a484-017019e2fe7b",
 CellTags->"Info233769459461-2867981"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12932, 327, 349, 8, 31, "Input",ExpressionUUID->"1e3576eb-2814-44f5-afe0-86af587104bf"],
Cell[13284, 337, 177, 2, 35, "Output",ExpressionUUID->"dde3356a-82b9-4ab6-8a42-06a332a8bfdb"]
}, Open  ]]
}
]
*)

