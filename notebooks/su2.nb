(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69860,       1942]
NotebookOptionsPosition[     65613,       1865]
NotebookOutlinePosition[     65946,       1880]
CellTagsIndexPosition[     65903,       1877]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Symbolic", " ", "computations", " ", "with", " ", "SU", 
    RowBox[{"(", "2", ")"}], " ", "matrices"}], " ", "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"u", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"u", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"u1", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"u2", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"u2", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"u3", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"u3", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"u4", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"u4", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"phi1", "[", "x_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"phi1", "[", 
       RowBox[{"[", "x", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"phi2", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"phi2", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"b", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"b", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]1", "=", 
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {"1", "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]2", "=", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{"-", "I"}]},
        {"I", "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]3", "=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], " ", 
        RowBox[{"(", GridBox[{
           {"1", "0"},
           {"0", "1"}
          }], ")"}]}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "\[Sigma]1"}], "+", 
          RowBox[{
           RowBox[{"x", "[", "2", "]"}], " ", "\[Sigma]2"}], "+", 
          RowBox[{
           RowBox[{"x", "[", "3", "]"}], "\[Sigma]3"}]}], ")"}]}]}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"this", " ", "is", " ", "U", 
      RowBox[{"(", "2", ")"}]}], ";", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"SU", 
        RowBox[{"(", "2", ")"}], " ", "satisfied", " ", 
        SuperscriptBox[
         RowBox[{"x", "[", "0", "]"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"x", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"x", "[", "2", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"x", "[", "3", "]"}], "2"]}], " ", "\[Equal]", " ", "1"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Det", "[", 
    RowBox[{"U", "[", "u", "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "rotate", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"su2rot", "=", 
     RowBox[{
      RowBox[{"U", "[", "u1", "]"}], ".", 
      RowBox[{"U", "[", "u2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"soln", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"su2rot", "\[Equal]", 
       RowBox[{"U", "[", "a", "]"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Det", "[", "su2rot", "]"}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.770391574540556*^9, 3.770391579121574*^9}, {
  3.770391612686799*^9, 3.7703919771540203`*^9}, {3.770392389205418*^9, 
  3.770392435630269*^9}, {3.770392495394515*^9, 3.7703925072327547`*^9}, {
  3.770545947025609*^9, 3.770545956948204*^9}, {3.770546271144032*^9, 
  3.770546285652383*^9}, {3.770566765912394*^9, 3.7705667891142282`*^9}, {
  3.770567768979899*^9, 3.7705678482736807`*^9}, {3.770567900844837*^9, 
  3.7705679393706903`*^9}, {3.770794020314049*^9, 3.770794033892874*^9}, {
  3.770794124926161*^9, 3.770794161191593*^9}, {3.77079423709309*^9, 
  3.770794244926085*^9}, {3.771483776707506*^9, 3.771483781860847*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7158afba-1ebd-4121-bf8b-2067947441a7"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"u", "[", "0", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "1", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "2", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"u", "[", "3", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.7703917984676657`*^9, 3.7703918129544277`*^9}, 
   3.770391868541424*^9, {3.7703919254133043`*^9, 3.77039197747958*^9}, 
   3.770392391539356*^9, {3.77039242963309*^9, 3.770392436054509*^9}, {
   3.770392502781877*^9, 3.770392508421842*^9}, 3.770546235120713*^9, 
   3.770546286615572*^9, {3.770566777691684*^9, 3.770566789441596*^9}, {
   3.770567782809141*^9, 3.770567849218215*^9}, {3.770567907079225*^9, 
   3.770567939645319*^9}, 3.770630535092183*^9, 3.770646126996483*^9, 
   3.770648256098609*^9, 3.770655605831524*^9, 3.7707094183170443`*^9, {
   3.7707940152072*^9, 3.770794034639192*^9}, {3.7707941399669037`*^9, 
   3.770794161514325*^9}, 3.7711341913068438`*^9, 3.771161126002141*^9, 
   3.7711657434764853`*^9, 3.771221309023747*^9, 3.771481336143745*^9, 
   3.771483782826603*^9, 3.771650180785162*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"04367c64-0d66-4bdf-8278-e6c79854d31b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7703917984676657`*^9, 3.7703918129544277`*^9}, 
   3.770391868541424*^9, {3.7703919254133043`*^9, 3.77039197747958*^9}, 
   3.770392391539356*^9, {3.77039242963309*^9, 3.770392436054509*^9}, {
   3.770392502781877*^9, 3.770392508421842*^9}, 3.770546235120713*^9, 
   3.770546286615572*^9, {3.770566777691684*^9, 3.770566789441596*^9}, {
   3.770567782809141*^9, 3.770567849218215*^9}, {3.770567907079225*^9, 
   3.770567939645319*^9}, 3.770630535092183*^9, 3.770646126996483*^9, 
   3.770648256098609*^9, 3.770655605831524*^9, 3.7707094183170443`*^9, {
   3.7707940152072*^9, 3.770794034639192*^9}, {3.7707941399669037`*^9, 
   3.770794161514325*^9}, 3.7711341913068438`*^9, 3.771161126002141*^9, 
   3.7711657434764853`*^9, 3.771221309023747*^9, 3.771481336143745*^9, 
   3.771483782826603*^9, 3.771650180859963*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"134b8f62-f2ed-4239-91c9-aff6d50cb54e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u1", "[", "0", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u1", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u1", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u1", "[", "3", "]"}], "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"u2", "[", "0", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u2", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u2", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"u2", "[", "3", "]"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7703917984676657`*^9, 3.7703918129544277`*^9}, 
   3.770391868541424*^9, {3.7703919254133043`*^9, 3.77039197747958*^9}, 
   3.770392391539356*^9, {3.77039242963309*^9, 3.770392436054509*^9}, {
   3.770392502781877*^9, 3.770392508421842*^9}, 3.770546235120713*^9, 
   3.770546286615572*^9, {3.770566777691684*^9, 3.770566789441596*^9}, {
   3.770567782809141*^9, 3.770567849218215*^9}, {3.770567907079225*^9, 
   3.770567939645319*^9}, 3.770630535092183*^9, 3.770646126996483*^9, 
   3.770648256098609*^9, 3.770655605831524*^9, 3.7707094183170443`*^9, {
   3.7707940152072*^9, 3.770794034639192*^9}, {3.7707941399669037`*^9, 
   3.770794161514325*^9}, 3.7711341913068438`*^9, 3.771161126002141*^9, 
   3.7711657434764853`*^9, 3.771221309023747*^9, 3.771481336143745*^9, 
   3.771483782826603*^9, 3.7716501809166183`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"c5d72da0-3014-4796-b8e2-0e8a9afee235"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"rotate", " ", "with", " ", "adjoint"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"su2rot", "=", 
     RowBox[{
      RowBox[{"U", "[", "u1", "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"U", "[", "u2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"soln", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"su2rot", "\[Equal]", 
        RowBox[{"U", "[", "a", "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", "ComplexExpand"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.770646131889526*^9, 3.770646150855441*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"634382f2-042a-4604-8de5-d44d6acb7323"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"u1", "[", "3", "]"}], " ", 
      RowBox[{"u2", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "2", "]"}], " ", 
      RowBox[{"u2", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"u1", "[", "1", "]"}], " ", 
      RowBox[{"u2", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"u1", "[", "0", "]"}], " ", 
      RowBox[{"u2", "[", "3", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7706461469260397`*^9, 3.770646151344007*^9}, {
  3.770648254524777*^9, 3.7706482579565277`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"aa06d5fb-7749-4ab2-a3f7-8fea60e825e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"plaquette", " ", "trace"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ptrace", "=", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"U", "[", "u1", "]"}], ".", 
        RowBox[{"U", "[", "u2", "]"}], ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"U", "[", "u3", "]"}], "]"}], ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"U", "[", "u4", "]"}], "]"}]}], "]"}], "//", 
      "ComplexExpand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CForm", "[", "ptrace", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7705459593457527`*^9, 3.770545967891387*^9}, {
  3.770546051944372*^9, 3.77054609095225*^9}, {3.770546137261656*^9, 
  3.77054614406082*^9}, {3.77054620619841*^9, 3.7705462251062517`*^9}, {
  3.7705462599879007`*^9, 3.77054626806184*^9}, {3.770546650338974*^9, 
  3.770546650892837*^9}, {3.7705466938736057`*^9, 3.7705466956827803`*^9}, {
  3.770550099073138*^9, 3.770550210730023*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"758a4151-d9cc-4312-a6fe-8c632df15748"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"untraced", " ", "counterclockwise", " ", "staple"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CCWstaple", "=", 
     RowBox[{
      RowBox[{"U", "[", "u1", "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"U", "[", "u2", "]"}], "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"U", "[", "u3", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soln", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"CCWstaple", "\[Equal]", 
         RowBox[{"U", "[", "a", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "ComplexExpand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CForm", "[", 
    RowBox[{"soln", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "2"}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.77062980199481*^9, 3.770629806449548*^9}, {
  3.770630377394895*^9, 3.7706303909944143`*^9}, {3.770630499790133*^9, 
  3.7706306456040697`*^9}, {3.770630729178832*^9, 3.770630731795356*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"10ba7e00-d6eb-472b-a41f-2174f1a071e1"],

Cell["\<\
u1[3]*u2[0]*u3[0] - u1[2]*u2[1]*u3[0] + u1[1]*u2[2]*u3[0] - u1[0]*u2[3]*u3[0] \
- 
   u1[2]*u2[0]*u3[1] - u1[3]*u2[1]*u3[1] + u1[0]*u2[2]*u3[1] + 
   u1[1]*u2[3]*u3[1] + u1[1]*u2[0]*u3[2] - u1[0]*u2[1]*u3[2] - 
   u1[3]*u2[2]*u3[2] + u1[2]*u2[3]*u3[2] - u1[0]*u2[0]*u3[3] - 
   u1[1]*u2[1]*u3[3] - u1[2]*u2[2]*u3[3] - u1[3]*u2[3]*u3[3]\
\>", "Output",
 CellChangeTimes->{3.77063073636616*^9},
 CellLabel->
  "Out[38]//CForm=",ExpressionUUID->"034a23e9-1148-4c4c-8d03-d23e9da48252"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"untraced", " ", "clockwise", " ", "staple"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CCWstaple", "=", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"U", "[", "u1", "]"}], "]"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"U", "[", "u2", "]"}], "]"}], ".", 
      RowBox[{"U", "[", "u3", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soln", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{"CCWstaple", "\[Equal]", 
         RowBox[{"U", "[", "a", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "ComplexExpand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"CForm", "[", 
    RowBox[{"soln", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "2"}], "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7706307393221283`*^9, 3.770630822527721*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"acfacafd-cede-4cca-82b3-3720d2beefb0"],

Cell["\<\
-(u1[3]*u2[0]*u3[0]) + u1[2]*u2[1]*u3[0] - u1[1]*u2[2]*u3[0] - 
   u1[0]*u2[3]*u3[0] - u1[2]*u2[0]*u3[1] - u1[3]*u2[1]*u3[1] - 
   u1[0]*u2[2]*u3[1] + u1[1]*u2[3]*u3[1] + u1[1]*u2[0]*u3[2] + 
   u1[0]*u2[1]*u3[2] - u1[3]*u2[2]*u3[2] + u1[2]*u2[3]*u3[2] + 
   u1[0]*u2[0]*u3[3] - u1[1]*u2[1]*u3[3] - u1[2]*u2[2]*u3[3] - \
u1[3]*u2[3]*u3[3]\
\>", "Output",
 CellChangeTimes->{{3.770630527746263*^9, 3.7706305453787527`*^9}, {
  3.770630580057776*^9, 3.770630646012802*^9}, {3.770630735583666*^9, 
  3.7706308229120407`*^9}},
 CellLabel->
  "Out[59]//CForm=",ExpressionUUID->"b9d10dce-e61d-4af1-a76a-f4cfe79c08f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", 
     RowBox[{"doublets", ".", " ", "Lattice"}], " ", "units"}], ",", " ", 
    RowBox[{
     RowBox[{"ie", ".", " ", "scaling"}], " ", "by", " ", "a"}], ",", " ", 
    RowBox[{"are", " ", "assumed"}]}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"usually", " ", "in", " ", 
    RowBox[{"continuum", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", "a_", "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "+", 
           RowBox[{"I", " ", 
            RowBox[{"a", "[", "1", "]"}]}]}]},
         {
          RowBox[{
           RowBox[{"a", "[", "2", "]"}], "+", 
           RowBox[{"I", " ", 
            RowBox[{"a", "[", "3", "]"}]}]}]}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "which", " ", "gives", " ", "conventional", " ", "normalization", " ", 
     "for", " ", "kinetic", " ", "terms", " ", 
     RowBox[{"etc", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[Phi]", "[", "a", "]"}], "]"}], ".", 
        RowBox[{"\[Phi]", "[", "a", "]"}]}]}], "+", 
      RowBox[{"\[Lambda]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"\[Phi]", "[", "a", "]"}], "]"}], ".", 
          RowBox[{"\[Phi]", "[", "a", "]"}]}], ")"}], "2"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"Tr", "[", "V", "]"}], "//", "ComplexExpand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", 
    RowBox[{"V", ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["m", "2"], ",", "\[Lambda]"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"on", " ", "lattice"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"it", "'"}], "s", " ", "more", " ", "convenient", " ", "to", 
       " ", "use", " ", 
       RowBox[{"matrices", ".", " ", "Following"}], " ", "hep"}], "-", 
      RowBox[{"lat", "/", "9504001"}]}], ","}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]", "[", "a_", "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], 
         RowBox[{"(", GridBox[{
            {"1", "0"},
            {"0", "1"}
           }], ")"}]}], "+", 
        RowBox[{"I", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", "1", "]"}], "\[Sigma]1"}], "+", 
           RowBox[{
            RowBox[{"a", "[", "2", "]"}], " ", "\[Sigma]2"}], "+", 
           RowBox[{
            RowBox[{"a", "[", "3", "]"}], "\[Sigma]3"}]}], ")"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"and", " ", "the", " ", "corresponding", " ", "potential", " ", 
     RowBox[{"is", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vlat", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        SuperscriptBox["m", "2"], 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
          RowBox[{"\[CapitalPhi]", "[", "a", "]"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], "\[Lambda]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Tr", "[", 
           RowBox[{
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
            RowBox[{"\[CapitalPhi]", "[", "a", "]"}]}], "]"}], ")"}], 
         "2"]}]}], "//", "ComplexExpand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", 
    RowBox[{"Vlat", ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["m", "2"], ",", "\[Lambda]"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "normalizations", " ", 
      "of", " ", "the", " ", 
      RowBox[{"a", "[", "i", "]"}], " ", "are", " ", "the", " ", "same", " ", 
      "in", " ", "both", " ", 
      RowBox[{"schemes", ".", " ", "The"}], " ", "values", " ", "may", " ", 
      "differ", " ", "though"}], ",", " ", 
     RowBox[{
      RowBox[{
      "but", " ", "we", " ", "only", " ", "care", " ", "about", " ", "the", 
       " ", "gauge"}], "-", 
      RowBox[{"invariant", " ", 
       SuperscriptBox["\[Phi]", "\[Dagger]"], "\[Phi]", " ", 
       RowBox[{"anyway", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", "to", " ", "measure", " ", 
      SuperscriptBox["\[Phi]", "\[Dagger]"], "\[Phi]"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "thus", " ", "want", " ", "to", " ", "measure", " ", 
       FractionBox["1", "2"], "Tr", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[CapitalPhi]", "\[Dagger]"], "\[CapitalPhi]"}], 
        ")"}]}], " ", "=", " ", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", "i", "]"}], 
         RowBox[{"a", "[", "i", "]"}]}], ")"}], " ", "on", " ", "the", " ", 
       RowBox[{"lattice", "."}]}]}]}], " ", "**)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.770709420664188*^9, 3.7707095465747538`*^9}, {
  3.770709597532456*^9, 3.7707096089390306`*^9}, {3.770709664152357*^9, 
  3.7707097511036587`*^9}, {3.770709782338669*^9, 3.770709844820991*^9}, {
  3.770710328098072*^9, 3.770710349440571*^9}, {3.770710388975918*^9, 
  3.770710422646584*^9}, {3.7707104739975233`*^9, 3.7707104755407887`*^9}, {
  3.770710627288995*^9, 3.770710653216674*^9}, {3.770710701431596*^9, 
  3.770710763229793*^9}, {3.7707108548594646`*^9, 3.7707109384655237`*^9}, {
  3.7707114325094624`*^9, 3.770711439364875*^9}, {3.770790532447035*^9, 
  3.770790543966461*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c95d4d34-aeda-4ba6-8a88-a4993cc64b51"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["m", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], "2"]}], ")"}]}], "+", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "4"], "4"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7707095168585033`*^9, 3.770709546797695*^9}, {
   3.77070959780064*^9, 3.770709609340569*^9}, 3.770709674177043*^9, {
   3.7707098155078087`*^9, 3.770709845039989*^9}, 3.7707103189147882`*^9, 
   3.7707103496507273`*^9, {3.770710398136421*^9, 3.770710422934407*^9}, 
   3.770710939772641*^9, 3.77079404064189*^9, 3.771134196879155*^9, 
   3.7711343080200977`*^9, 3.771221499992729*^9, 3.771481340891528*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"fa020507-e063-4d54-ac0d-83fb7652bd00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["m", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], "2"], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], "2"]}], ")"}]}], "+", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"], "4"], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "4"], "4"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7707095168585033`*^9, 3.770709546797695*^9}, {
   3.77070959780064*^9, 3.770709609340569*^9}, 3.770709674177043*^9, {
   3.7707098155078087`*^9, 3.770709845039989*^9}, 3.7707103189147882`*^9, 
   3.7707103496507273`*^9, {3.770710398136421*^9, 3.770710422934407*^9}, 
   3.770710939772641*^9, 3.77079404064189*^9, 3.771134196879155*^9, 
   3.7711343080200977`*^9, 3.771221499992729*^9, 3.771481340893862*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"52ce3778-e9d6-48e3-a4f4-4dfd27f17d9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "Covariant", " ", 
    RowBox[{"derivative", "."}]}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "In", " ", "continuum", " ", "this", " ", "can", " ", "be", " ", "written",
     " ", "in", " ", "the", " ", "matrix", " ", "notation", " ", "as", " ", 
    FractionBox["1", "2"], "Tr", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["D", "i"], "\[CapitalPhi]"}], ")"}], "\[Dagger]"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["D", "i"], "\[CapitalPhi]"}], ")"}], "."}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "in", " ", "discretization", " ", "theres", " ", "an", " ", "extra", " ", 
     "factor", " ", "of", " ", "2"}], ",", " ", 
    RowBox[{"so", " ", "on", " ", "the", " ", 
     RowBox[{"lattice", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"cov", "=", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]", "]"}], ".", 
       "\[CapitalPhi]"}], "]"}], "-", 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]", "]"}], ".", "U", 
       ".", "\[CapitalPhi]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"with", " ", "a", " ", "sum", " ", "over", " ", "directions", " ", 
     RowBox[{"implied", ".", "\[IndentingNewLine]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.770790328725856*^9, 3.7707904862933683`*^9}, {
  3.770790553537146*^9, 3.770790591178093*^9}, {3.770791160448337*^9, 
  3.770791162905616*^9}, {3.770792617491397*^9, 
  3.770792666198441*^9}},ExpressionUUID->"4ec5d572-18d3-423a-93d4-\
7a80d4f9e1e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]", "]"}], ".", 
    "\[CapitalPhi]"}], "]"}], "-", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]", "]"}], ".", 
    RowBox[{"U", "[", "u", "]"}], ".", "\[CapitalPhi]"}], "]"}]}]], "Output",
 CellChangeTimes->{3.77079265289288*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"e77c3643-8961-4792-ba72-f7f6fa392705"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "calculate", " ", "hopping", " ", "trace"}], " ", 
   "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hop", "=", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"\[CapitalPhi]", "[", "phi1", "]"}], "]"}], ".", 
        RowBox[{"U", "[", "u", "]"}], ".", 
        RowBox[{"\[CapitalPhi]", "[", "phi2", "]"}]}], "]"}], "//", 
      "ComplexExpand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"CForm", "[", "hop", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.770793984494214*^9, 3.7707940047532377`*^9}, {
  3.770794049944294*^9, 3.770794074800486*^9}, {3.77079411041646*^9, 
  3.770794114876547*^9}, {3.770794174990947*^9, 3.770794180525343*^9}, {
  3.770794216077055*^9, 3.770794219643854*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b97ee14b-b137-414b-aae2-d21bc41a52f5"],

Cell["\<\
phi1[0]*phi2[0]*u[0] + phi1[1]*phi2[1]*u[0] + phi1[2]*phi2[2]*u[0] + 
   phi1[3]*phi2[3]*u[0] + phi1[1]*phi2[0]*u[1] - phi1[0]*phi2[1]*u[1] - 
   phi1[3]*phi2[2]*u[1] + phi1[2]*phi2[3]*u[1] + phi1[2]*phi2[0]*u[2] + 
   phi1[3]*phi2[1]*u[2] - phi1[0]*phi2[2]*u[2] - phi1[1]*phi2[3]*u[2] + 
   phi1[3]*phi2[0]*u[3] - phi1[2]*phi2[1]*u[3] + phi1[1]*phi2[2]*u[3] - 
   phi1[0]*phi2[3]*u[3]\
\>", "Output",
 CellChangeTimes->{
  3.7707940053282337`*^9, {3.7707940431371717`*^9, 3.770794075121169*^9}, {
   3.770794115543375*^9, 3.770794180883387*^9}, 3.770794220146473*^9, 
   3.771134500613367*^9},
 CellLabel->
  "Out[37]//CForm=",ExpressionUUID->"4936bf79-7aba-4db2-862e-9dc9902e8970"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"ConjugateTranspose", "[", 
      RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "]"}], ".", 
     RowBox[{"\[CapitalPhi]", "[", "a", "]"}]}], "]"}]}], "//", 
  "ComplexExpand"}]], "Input",
 CellChangeTimes->{{3.770710589130802*^9, 3.770710599842434*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"d2dc0607-d66b-44e8-a1c2-f2fc53d7d7e0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "0", "]"}], "2"], "2"], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], "2"], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], "2"], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "2"], "2"]}]], "Output",
 CellChangeTimes->{{3.7707105905953493`*^9, 3.7707106000569677`*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"9302d266-7908-4c61-9b23-0261ec596dbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"\[Phi]", "[", "a", "]"}], "]"}], ".", 
   RowBox[{"\[Phi]", "[", "a", "]"}]}], "//", "ComplexExpand"}]], "Input",
 CellChangeTimes->{3.770710886427936*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"4ef1d244-755a-4fee-9c45-5508f6c67078"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"], "2"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], "2"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"], "2"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"], "2"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.770710882245222*^9, 3.770710886780507*^9}},
 CellLabel->
  "Out[108]=",ExpressionUUID->"035d9cd3-0461-4eb2-8807-0726a6747762"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "phi1", "]"}], ".", 
      RowBox[{"\[CapitalPhi]", "[", "phi2", "]"}]}], "//", "ComplexExpand"}], 
    ")"}], "\[Equal]", 
   RowBox[{"\[CapitalPhi]", "[", "u", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.771146640147944*^9, 3.771146678794737*^9}, {
  3.771146757537562*^9, 3.7711467713380117`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"adfae799-cff0-4ea0-8a79-e372a95b36e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "0", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"phi1", "[", "0", "]"}], " ", 
        RowBox[{"phi2", "[", "0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "1", "]"}], " ", 
        RowBox[{"phi2", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "2", "]"}], " ", 
        RowBox[{"phi2", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "3", "]"}], " ", 
        RowBox[{"phi2", "[", "3", "]"}]}]}], 
      SqrtBox["2"]]}], ",", 
    RowBox[{
     RowBox[{"u", "[", "1", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"phi1", "[", "1", "]"}], " ", 
        RowBox[{"phi2", "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "0", "]"}], " ", 
        RowBox[{"phi2", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "3", "]"}], " ", 
        RowBox[{"phi2", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "2", "]"}], " ", 
        RowBox[{"phi2", "[", "3", "]"}]}]}], 
      SqrtBox["2"]]}], ",", 
    RowBox[{
     RowBox[{"u", "[", "2", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"phi1", "[", "2", "]"}], " ", 
        RowBox[{"phi2", "[", "0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "3", "]"}], " ", 
        RowBox[{"phi2", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "0", "]"}], " ", 
        RowBox[{"phi2", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "1", "]"}], " ", 
        RowBox[{"phi2", "[", "3", "]"}]}]}], 
      SqrtBox["2"]]}], ",", 
    RowBox[{
     RowBox[{"u", "[", "3", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"phi1", "[", "3", "]"}], " ", 
        RowBox[{"phi2", "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "2", "]"}], " ", 
        RowBox[{"phi2", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"phi1", "[", "1", "]"}], " ", 
        RowBox[{"phi2", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"phi1", "[", "0", "]"}], " ", 
        RowBox[{"phi2", "[", "3", "]"}]}]}], 
      SqrtBox["2"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.771146659602086*^9, 3.771146679086493*^9}, {
  3.7711467586514797`*^9, 3.771146777448021*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"e6eda822-7b97-46f4-b66b-2f7d68bd0e96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "\[Equal]", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"a3", "+", 
         RowBox[{"I", " ", "a4"}]}]},
       {
        RowBox[{"a1", "+", 
         RowBox[{"I", " ", "a2"}]}]}
      }], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7711481565995893`*^9, 3.7711481881016903`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"4e33c4b1-e54c-44bb-a694-278e603b1cb9"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.771148188666161*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"d5d32894-9c8f-4430-a857-51c279ff0a2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.771148198280098*^9, 3.771148199495439*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"ec550a02-11be-4c9e-aedf-ca6f4b2f39fa"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"a", "[", "0", "]"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "1", "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", "1", "]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", "2", "]"}]}]}], ")"}]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"a", "[", "0", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}]}], 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7711481931836777`*^9, 3.771148199729272*^9}},
 CellLabel->
  "Out[49]//MatrixForm=",ExpressionUUID->"3472ca48-d9ce-4cb7-96de-\
77fb023572e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]2", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"a3", "+", 
         RowBox[{"I", " ", "a4"}]}]},
       {
        RowBox[{"a1", "+", 
         RowBox[{"I", " ", "a2"}]}]}
      }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U1", "=", 
   RowBox[{"U", "[", "b", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"c3", "+", 
          RowBox[{"I", " ", "c4"}]}]},
        {
         RowBox[{"c1", "+", 
          RowBox[{"I", " ", "c2"}]}]}
       }], ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"david", "=", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "\[Phi]1", "]"}], ".", "U1", ".", 
      "\[Phi]2"}]}], "//", "ComplexExpand"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"david", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Tr", "[", "david", "]"}], "/.", 
           RowBox[{"a1", "\[Rule]", " ", 
            RowBox[{"a", "[", "0", "]"}]}]}], "/.", 
          RowBox[{"a2", "\[Rule]", " ", 
           RowBox[{"a", "[", "1", "]"}]}]}], "/.", 
         RowBox[{"a3", "\[Rule]", 
          RowBox[{"a", "[", "2", "]"}]}]}], "/.", 
        RowBox[{"a4", "\[Rule]", 
         RowBox[{"a", "[", "3", "]"}]}]}], "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"c", "[", "0", "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", " ", 
       RowBox[{"c", "[", "1", "]"}]}]}], "/.", 
     RowBox[{"c3", "\[Rule]", 
      RowBox[{"c", "[", "2", "]"}]}]}], "/.", 
    RowBox[{"c4", "\[Rule]", 
     RowBox[{"c", "[", "3", "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "a", "]"}], "/.", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "\[Rule]", " ", "temp"}]}], "/.", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], "\[Rule]", " ", 
      RowBox[{"-", 
       RowBox[{"a", "[", "1", "]"}]}]}]}], "/.", 
    RowBox[{"temp", "\[Rule]", " ", 
     RowBox[{"a", "[", "3", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "c", "]"}], "/.", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], "\[Rule]", " ", "temp"}]}], "/.", 
      RowBox[{
       RowBox[{"c", "[", "3", "]"}], "\[Rule]", " ", 
       RowBox[{"-", 
        RowBox[{"c", "[", "1", "]"}]}]}]}], "/.", 
     RowBox[{"temp", "\[Rule]", " ", 
      RowBox[{"c", "[", "3", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[ADoubleDot]", "=", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]1", "]"}], ".", "U1", 
      ".", "\[CapitalPhi]2"}], "]"}], "//", "ComplexExpand"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"m\[ADoubleDot]", "-", "david"}], "]"}], "//", "ComplexExpand"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"\[CapitalPhi]2", ".", 
      RowBox[{"ConjugateTranspose", "[", "\[CapitalPhi]1", "]"}]}], 
     "\[Equal]", 
     RowBox[{"\[CapitalPhi]", "[", "new", "]"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", 
  "ComplexExpand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SqrtBox["2"], 
    RowBox[{"soln", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/.", "convert"}], "//", 
  "Expand"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.771148631563295*^9, 3.7711486478907843`*^9}, {
  3.771148713953437*^9, 3.771148845097685*^9}, {3.7711491850466213`*^9, 
  3.771149372896435*^9}, {3.7711494432252007`*^9, 3.771149474181636*^9}, {
  3.771149511918268*^9, 3.771149525634583*^9}, {3.7711516461910543`*^9, 
  3.771151649950629*^9}, {3.7711522704572477`*^9, 3.771152319728071*^9}, {
  3.771152352151657*^9, 3.771152492283503*^9}},
 CellLabel->
  "In[604]:=",ExpressionUUID->"732302bc-3690-4eb5-b046-42b55f0ebbdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "0", "]"}], " ", 
      RowBox[{"c", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"c", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"c", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"c", "[", "0", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"b", "[", "0", "]"}], " ", 
      RowBox[{"c", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"c", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"c", "[", "1", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"c", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "0", "]"}], " ", 
      RowBox[{"c", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"c", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"c", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"c", "[", "2", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "0", "]"}], " ", 
      RowBox[{"c", "[", "3", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"c", "[", "3", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"c", "[", "3", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"c", "[", "3", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.771148734109221*^9, {3.771148764911664*^9, 3.771148770794127*^9}, {
   3.7711488310061502`*^9, 3.771148845438178*^9}, {3.771149211898458*^9, 
   3.77114921484935*^9}, {3.771149254142055*^9, 3.771149373916855*^9}, 
   3.771149474640314*^9, {3.7711495197828283`*^9, 3.7711495259101543`*^9}, 
   3.77115164434468*^9, 3.771151679137249*^9, {3.7711522718807163`*^9, 
   3.7711523202254066`*^9}, {3.771152352593403*^9, 3.771152367920988*^9}, {
   3.771152413790288*^9, 3.771152493074245*^9}},
 CellLabel->
  "Out[608]=",ExpressionUUID->"d70cf3d4-3fbd-4c3e-8375-39e5cc2c55d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"b", "[", "0", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"c", "[", "3", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.771148734109221*^9, {3.771148764911664*^9, 3.771148770794127*^9}, {
   3.7711488310061502`*^9, 3.771148845438178*^9}, {3.771149211898458*^9, 
   3.77114921484935*^9}, {3.771149254142055*^9, 3.771149373916855*^9}, 
   3.771149474640314*^9, {3.7711495197828283`*^9, 3.7711495259101543`*^9}, 
   3.77115164434468*^9, 3.771151679137249*^9, {3.7711522718807163`*^9, 
   3.7711523202254066`*^9}, {3.771152352593403*^9, 3.771152367920988*^9}, {
   3.771152413790288*^9, 3.771152493096333*^9}},
 CellLabel->
  "Out[611]=",ExpressionUUID->"ff3d401e-9563-4050-9f1d-4010196e6534"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.771148734109221*^9, {3.771148764911664*^9, 3.771148770794127*^9}, {
   3.7711488310061502`*^9, 3.771148845438178*^9}, {3.771149211898458*^9, 
   3.77114921484935*^9}, {3.771149254142055*^9, 3.771149373916855*^9}, 
   3.771149474640314*^9, {3.7711495197828283`*^9, 3.7711495259101543`*^9}, 
   3.77115164434468*^9, 3.771151679137249*^9, {3.7711522718807163`*^9, 
   3.7711523202254066`*^9}, {3.771152352593403*^9, 3.771152367920988*^9}, {
   3.771152413790288*^9, 3.771152493098213*^9}},
 CellLabel->
  "Out[612]=",ExpressionUUID->"65b2b45e-bccb-467a-8a20-63b4f6f38c9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"new", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"c", "[", "0", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"c", "[", "1", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"c", "[", "2", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"c", "[", "3", "]"}]}], 
      SqrtBox["2"]]}]}], ",", 
   RowBox[{
    RowBox[{"new", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"c", "[", "0", "]"}]}], 
      SqrtBox["2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"c", "[", "1", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"c", "[", "2", "]"}]}], 
      SqrtBox["2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"c", "[", "3", "]"}]}], 
      SqrtBox["2"]]}]}], ",", 
   RowBox[{
    RowBox[{"new", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"c", "[", "0", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"c", "[", "1", "]"}]}], 
      SqrtBox["2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"c", "[", "2", "]"}]}], 
      SqrtBox["2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"c", "[", "3", "]"}]}], 
      SqrtBox["2"]]}]}], ",", 
   RowBox[{
    RowBox[{"new", "[", "3", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"a", "[", "1", "]"}], " ", 
        RowBox[{"c", "[", "0", "]"}]}], 
       SqrtBox["2"]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"c", "[", "1", "]"}]}], 
      SqrtBox["2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"c", "[", "2", "]"}]}], 
      SqrtBox["2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"c", "[", "3", "]"}]}], 
      SqrtBox["2"]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.771148734109221*^9, {3.771148764911664*^9, 3.771148770794127*^9}, {
   3.7711488310061502`*^9, 3.771148845438178*^9}, {3.771149211898458*^9, 
   3.77114921484935*^9}, {3.771149254142055*^9, 3.771149373916855*^9}, 
   3.771149474640314*^9, {3.7711495197828283`*^9, 3.7711495259101543`*^9}, 
   3.77115164434468*^9, 3.771151679137249*^9, {3.7711522718807163`*^9, 
   3.7711523202254066`*^9}, {3.771152352593403*^9, 3.771152367920988*^9}, {
   3.771152413790288*^9, 3.7711524931606503`*^9}},
 CellLabel->
  "Out[613]=",ExpressionUUID->"a7de56f5-1503-4709-bdc2-892d46fbc413"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "c1"}], "+", 
  RowBox[{"a2", " ", "c2"}], "+", 
  RowBox[{"a3", " ", "c3"}], "+", 
  RowBox[{"a4", " ", "c4"}]}]], "Output",
 CellChangeTimes->{
  3.771148734109221*^9, {3.771148764911664*^9, 3.771148770794127*^9}, {
   3.7711488310061502`*^9, 3.771148845438178*^9}, {3.771149211898458*^9, 
   3.77114921484935*^9}, {3.771149254142055*^9, 3.771149373916855*^9}, 
   3.771149474640314*^9, {3.7711495197828283`*^9, 3.7711495259101543`*^9}, 
   3.77115164434468*^9, 3.771151679137249*^9, {3.7711522718807163`*^9, 
   3.7711523202254066`*^9}, {3.771152352593403*^9, 3.771152367920988*^9}, {
   3.771152413790288*^9, 3.771152493162747*^9}},
 CellLabel->
  "Out[614]=",ExpressionUUID->"c268b95b-e2d2-436a-bf5f-ab6c349f1816"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "adjoint", " ", "scalars"}], " ", "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalSigma]", "[", "x_", "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], "\[Sigma]1"}], "+", 
        RowBox[{
         RowBox[{"x", "[", "1", "]"}], "\[Sigma]2"}], "+", 
        RowBox[{
         RowBox[{"x", "[", "2", "]"}], "\[Sigma]3"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "[", "a", "]"}], ".", 
      RowBox[{"\[CapitalSigma]", "[", "a", "]"}]}], "]"}], "//", 
    "ComplexExpand"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"hopping", " ", "trace"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"a1", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"a1", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"a2", "[", "a_", "]"}], ",", "CForm"}], "]"}], ":=", 
     RowBox[{"HoldForm", "[", 
      RowBox[{"a2", "[", 
       RowBox[{"[", "a", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Unprotect", "[", "Power", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"n_Integer", "?", "Positive"}]}], "]"}], ",", "CForm"}], 
     "]"}], ":=", 
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"Hold", "[", "a", "]"}], ",", "n"}], "]"}], ",", "Hold", ",", 
      "List", ",", "HoldForm", ",", "Times"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Protect", "[", "Power", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Uj", "=", 
     RowBox[{"U", "[", "u", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "is", " ", "prettier", " ", "when", " ", "multiplied", " ", "by", " ", 
     "2.", " ", "in", " ", "the", " ", "code", " ", "I", " ", "compensate", 
     " ", "this", " ", "by", " ", "multiplying", " ", "by", " ", 
     RowBox[{"0.5", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hop", "=", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"\[CapitalSigma]", "[", "a1", "]"}], ".", "Uj", ".", 
         RowBox[{"\[CapitalSigma]", "[", "a2", "]"}], ".", 
         RowBox[{"ConjugateTranspose", "[", "Uj", "]"}]}], "]"}]}], "//", 
      "ComplexExpand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"CForm", "[", "hop", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.771161011171433*^9, 3.771161108102346*^9}, {
  3.771161139327841*^9, 3.771161156499983*^9}, {3.771161188500477*^9, 
  3.771161218971135*^9}, {3.771161608400676*^9, 3.7711616120321913`*^9}, {
  3.771161910025042*^9, 3.771161916549662*^9}, {3.771162407438892*^9, 
  3.771162410152542*^9}, {3.771165728404262*^9, 3.771165835085465*^9}, {
  3.771165891987253*^9, 3.771165933970703*^9}, {3.77116596978481*^9, 
  3.7711659701750603`*^9}, {3.77116601905258*^9, 3.771166085696663*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"95412c9d-23f5-460f-a30f-3e76c3a087cd"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "0", "]"}], "2"], "2"], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], "2"], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], "2"]}]], "Output",
 CellChangeTimes->{{3.7711611494175253`*^9, 3.771161156802979*^9}, {
   3.7711612137526693`*^9, 3.7711612192897797`*^9}, 3.771161612552004*^9, {
   3.7711619106127043`*^9, 3.7711619171043253`*^9}, 3.771162410625121*^9, {
   3.771165804489197*^9, 3.771165835396649*^9}, {3.771165904714415*^9, 
   3.7711659342743998`*^9}, 3.771165970894141*^9, 3.771166019570063*^9, 
   3.771221312364698*^9, 3.7716501848536577`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"0aa29dd5-55df-49db-932b-0e8f387938ac"],

Cell["\<\
a1[0]*a2[0]*(u[0]*u[0]) + a1[1]*a2[1]*(u[0]*u[0]) + a1[2]*a2[2]*(u[0]*u[0]) - \

   2*a1[2]*a2[1]*u[0]*u[1] + 2*a1[1]*a2[2]*u[0]*u[1] + \
a1[0]*a2[0]*(u[1]*u[1]) - 
   a1[1]*a2[1]*(u[1]*u[1]) - a1[2]*a2[2]*(u[1]*u[1]) + \
2*a1[2]*a2[0]*u[0]*u[2] - 
   2*a1[0]*a2[2]*u[0]*u[2] + 2*a1[1]*a2[0]*u[1]*u[2] + \
2*a1[0]*a2[1]*u[1]*u[2] - 
   a1[0]*a2[0]*(u[2]*u[2]) + a1[1]*a2[1]*(u[2]*u[2]) - \
a1[2]*a2[2]*(u[2]*u[2]) - 
   2*a1[1]*a2[0]*u[0]*u[3] + 2*a1[0]*a2[1]*u[0]*u[3] + \
2*a1[2]*a2[0]*u[1]*u[3] + 
   2*a1[0]*a2[2]*u[1]*u[3] + 2*a1[2]*a2[1]*u[2]*u[3] + \
2*a1[1]*a2[2]*u[2]*u[3] - 
   a1[0]*a2[0]*(u[3]*u[3]) - a1[1]*a2[1]*(u[3]*u[3]) + a1[2]*a2[2]*(u[3]*u[3])\
\>", "Output",
 CellChangeTimes->{{3.7711611494175253`*^9, 3.771161156802979*^9}, {
   3.7711612137526693`*^9, 3.7711612192897797`*^9}, 3.771161612552004*^9, {
   3.7711619106127043`*^9, 3.7711619171043253`*^9}, 3.771162410625121*^9, {
   3.771165804489197*^9, 3.771165835396649*^9}, {3.771165904714415*^9, 
   3.7711659342743998`*^9}, 3.771165970894141*^9, 3.771166019570063*^9, 
   3.771221312364698*^9, 3.7716501848556767`*^9},
 CellLabel->
  "Out[26]//CForm=",ExpressionUUID->"39d56735-c531-417a-8579-ba442183c9aa"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{4, Automatic}, {11, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5736, 166, 648, "Input",ExpressionUUID->"7158afba-1ebd-4121-bf8b-2067947441a7"],
Cell[6319, 190, 1201, 22, 37, "Output",ExpressionUUID->"04367c64-0d66-4bdf-8278-e6c79854d31b"],
Cell[7523, 214, 2904, 75, 105, "Output",ExpressionUUID->"134b8f62-f2ed-4239-91c9-aff6d50cb54e"],
Cell[10430, 291, 1569, 34, 40, "Output",ExpressionUUID->"c5d72da0-3014-4796-b8e2-0e8a9afee235"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12036, 330, 785, 21, 101, "Input",ExpressionUUID->"634382f2-042a-4604-8de5-d44d6acb7323"],
Cell[12824, 353, 2183, 65, 105, "Output",ExpressionUUID->"aa06d5fb-7749-4ab2-a3f7-8fea60e825e1"]
}, Open  ]],
Cell[15022, 421, 1175, 27, 124, "Input",ExpressionUUID->"758a4151-d9cc-4312-a6fe-8c632df15748"],
Cell[CellGroupData[{
Cell[16222, 452, 1199, 30, 101, "Input",ExpressionUUID->"10ba7e00-d6eb-472b-a41f-2174f1a071e1"],
Cell[17424, 484, 491, 10, 126, "Output",ExpressionUUID->"034a23e9-1148-4c4c-8d03-d23e9da48252"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17952, 499, 1047, 28, 101, "Input",ExpressionUUID->"acfacafd-cede-4cca-82b3-3720d2beefb0"],
Cell[19002, 529, 621, 12, 126, "Output",ExpressionUUID->"b9d10dce-e61d-4af1-a76a-f4cfe79c08f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19660, 546, 6492, 174, 648, "Input",ExpressionUUID->"c95d4d34-aeda-4ba6-8a88-a4993cc64b51"],
Cell[26155, 722, 2614, 75, 168, "Output",ExpressionUUID->"fa020507-e063-4d54-ac0d-83fb7652bd00"],
Cell[28772, 799, 2614, 75, 168, "Output",ExpressionUUID->"52ce3778-e9d6-48e3-a4f4-4dfd27f17d9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31423, 879, 1802, 44, 181, "Input",ExpressionUUID->"4ec5d572-18d3-423a-93d4-7a80d4f9e1e9"],
Cell[33228, 925, 462, 11, 35, "Output",ExpressionUUID->"e77c3643-8961-4792-ba72-f7f6fa392705"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33727, 941, 949, 21, 101, "Input",ExpressionUUID->"b97ee14b-b137-414b-aae2-d21bc41a52f5"],
Cell[34679, 964, 693, 13, 145, "Output",ExpressionUUID->"4936bf79-7aba-4db2-862e-9dc9902e8970"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35409, 982, 444, 12, 56, "Input",ExpressionUUID->"d2dc0607-d66b-44e8-a1c2-f2fc53d7d7e0"],
Cell[35856, 996, 527, 16, 58, "Output",ExpressionUUID->"9302d266-7908-4c61-9b23-0261ec596dbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36420, 1017, 325, 8, 31, "Input",ExpressionUUID->"4ef1d244-755a-4fee-9c45-5508f6c67078"],
Cell[36748, 1027, 594, 18, 58, "Output",ExpressionUUID->"035d9cd3-0461-4eb2-8807-0726a6747762"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37379, 1050, 512, 12, 31, "Input",ExpressionUUID->"adfae799-cff0-4ea0-8a79-e372a95b36e0"],
Cell[37894, 1064, 2541, 74, 202, "Output",ExpressionUUID->"e6eda822-7b97-46f4-b66b-2f7d68bd0e96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40472, 1143, 524, 16, 62, "Input",ExpressionUUID->"4e33c4b1-e54c-44bb-a694-278e603b1cb9"],
Cell[40999, 1161, 166, 3, 35, "Output",ExpressionUUID->"d5d32894-9c8f-4430-a857-51c279ff0a2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41202, 1169, 244, 4, 31, "Input",ExpressionUUID->"ec550a02-11be-4c9e-aedf-ca6f4b2f39fa"],
Cell[41449, 1175, 1623, 49, 91, "Output",ExpressionUUID->"3472ca48-d9ce-4cb7-96de-77fb023572e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43109, 1229, 4484, 135, 517, "Input",ExpressionUUID->"732302bc-3690-4eb5-b046-42b55f0ebbdb"],
Cell[47596, 1366, 5050, 142, 174, "Output",ExpressionUUID->"d70cf3d4-3fbd-4c3e-8375-39e5cc2c55d8"],
Cell[52649, 1510, 2704, 75, 105, "Output",ExpressionUUID->"ff3d401e-9563-4050-9f1d-4010196e6534"],
Cell[55356, 1587, 622, 10, 35, "Output",ExpressionUUID->"65b2b45e-bccb-467a-8a20-63b4f6f38c9e"],
Cell[55981, 1599, 3271, 105, 195, "Output",ExpressionUUID->"a7de56f5-1503-4709-bdc2-892d46fbc413"],
Cell[59255, 1706, 764, 15, 35, "Output",ExpressionUUID->"c268b95b-e2d2-436a-bf5f-ab6c349f1816"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60056, 1726, 3558, 91, 449, "Input",ExpressionUUID->"95412c9d-23f5-460f-a30f-3e76c3a087cd"],
Cell[63617, 1819, 783, 17, 58, "Output",ExpressionUUID->"0aa29dd5-55df-49db-932b-0e8f387938ac"],
Cell[64403, 1838, 1194, 24, 183, "Output",ExpressionUUID->"39d56735-c531-417a-8579-ba442183c9aa"]
}, Open  ]]
}
]
*)

